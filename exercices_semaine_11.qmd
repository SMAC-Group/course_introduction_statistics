---
title: "Exercices Semaine 11"
format:
  html:
    html-math-method: mathjax
    includes:
      in_header: |
        <script type="text/javascript" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
        </script>
toc: false
editor: source
---

```{r, echo = FALSE, results='asis'}
knitr::opts_chunk$set(echo = FALSE)

# Uncomment to change widget colours:
#style_widgets(incorrect = "goldenrod", correct = "purple", highlight = "firebrick")
```

```{r}

add_backslashes <- function(input_string) {
  # Use regular expressions to replace single backslashes with double backslashes
  result <- gsub("\\\\", "\\\\\\\\", input_string)
  return(result)
}


longmcq2 <- function(opts) {
  
  
  
  ix <- which(names(opts) == "answer")
  if (length(ix) == 0) {
    stop("The question has no correct answer")
  }
  
  # Encode special characters
  opts2 <- gsub("\'", "&apos;", opts, fixed = TRUE)
  
  # Add mathjax wrapper to LaTeX expressions (fix regex)
  opts2 <- gsub("\\\\\\((.*?)\\\\\\)", "\\\\(\\1\\\\)", opts2)  # Wrap LaTeX expressions correctly
  
  # Generate a unique name for the radio buttons
  qname <- paste0("radio_", paste(sample(LETTERS, 10, T), collapse = ""))
  options <- sprintf('<label><input type="radio" autocomplete="off" name="%s" value="%s"></input> <span>%s</span></label>', qname, names(opts), opts2)
  
  # HTML format for display
  html <- paste0("<div class='webex-radiogroup' id='", qname, "'>",
                 paste(options, collapse = ""),
                 "</div>\n")
  
  # PDF format (no changes here)
  pdf_opts <- sprintf("* (%s) %s  ", LETTERS[seq_along(opts2)], opts2)
  pdf <- paste0("\n\n", paste(pdf_opts, collapse = "\n"), "\n\n")
  
  # Check the output format and return the appropriate version
  out_fmt <- knitr::opts_knit$get("out.format")
  pandoc_to <- knitr::opts_knit$get("rmarkdown.pandoc.to")
  
  add_backslashes( ifelse((is.null(out_fmt) & is.null(pandoc_to)) ||
                            isTRUE(out_fmt == "html") ||
                            isTRUE(pandoc_to == "html"),
                          html, pdf))
  
  
 
}

```

<!-- JavaScript -->

```{=html}
<script type="text/javascript">
function toggleAlert(event, message, type) {
  var alertBox = event.target.nextElementSibling; // Select the alert box next to the clicked button
  var alertMessage = alertBox.querySelector(".alertMessage");
  var alertType = alertBox.querySelector(".alertType");

  if (alertBox.style.display === "block") {
    alertBox.style.display = "none"; // Hide the alert box if it's already visible
  } else {
    alertMessage.innerHTML = message;
    alertType.innerHTML = (type === 'hint') ? '‚ùì Indice' : 'üí° Explication';

    // Change style based on type (yellow for hint, green for explanation)
    alertBox.style.backgroundColor = (type === 'hint') ? '#FFEDA3' : '#C0EDC2';  
    alertBox.style.borderColor = (type === 'hint') ? '#E5B800' : '#388E3C';  
    alertBox.style.display = "block";  // Show the alert

    MathJax.typesetPromise([alertMessage]);  // Re-render math with MathJax v3
  }
}
</script>
```

<!-- CSS for Styling -->

```{=html}
<style>
/* Custom styles for the buttons */
.custom-button {
  border: none;
  padding: 10px 20px;
  font-size: 16px;
  color: black;
  border-radius: 10px;
  cursor: pointer;
  transition: background 0.3s ease, transform 0.1s ease;
}

/* Green button for Explanation */
.explanation {
  background: #C0EDC2; /* Green */
  border: 2px solid #388E3C; /* Slightly darker green */
}

.explanation:hover {
  background: #388E3C; /* Darker green */
  transform: scale(1.08);
}

/* Yellow button for Hint */
.hint {
  background: #FFEDA3; /* Yellow */
  border: 2px solid #E5B800; /* Slightly darker yellow */
}

.hint:hover {
  background: #E5B800; /* Darker yellow */
  transform: scale(1.08);
}

/* Custom styles for the alert box */
.alert {
  padding: 15px;
  color: black;
  margin-top: 10px; /* Ensure spacing between button and alert */
  border-radius: 10px;
  border: 2px solid;
  font-size: 16px;
  width: fit-content; /* Prevent full-width alerts */
}
</style>
```

<!-- MathJax for Rendering Math -->

```{=html}
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js">
</script>
```




Dans le cadre d'une √©tude sur les d√©penses militaires par pays, on collecte le montant des d√©penses militaires (en milliards de dollars) pour \\(14\\) pays et on obtient les donn√©es suivantes:

\\(\\{50,65,45,70,55,60,48,72,52,68,58,62,47,75 \\}\\)


## Question 1

Calculez \\(\\bar{X}\\)

```{r}
opts <- c(
  answer ="\\( \\bar{X} = 59.07143\\)",
    "\\(\\bar{X} = 57.6451\\)",
  "\\(\\bar{X} = 53.3476\\)",
  "\\(\\bar{X} = 58.1253\\)"
)

```

```{r, results='asis'}
cat(longmcq2(opts))
```

<button class="custom-button hint" onclick="toggleAlert(event, 'Pour calculer la moyenne \\(\\bar{X}\\), additionnez toutes les valeurs et divisez par le nombre total de valeurs.', 'hint')"> ‚ùì Indice </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div> <div style="margin-top: 4px;"></div>

<button class="custom-button explanation" onclick="toggleAlert(event, 'La moyenne \\(\\bar{X}\\) est calcul√©e comme suit : \\(\\bar{X} = \\frac{50+65+45+70+55+60+48+72+52+68+58+62+47+75}{14} = 59.07143\\).', 'explanation')"> üí° Explication </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div>



## Question 2

Bas√© sur une pr√©c√©dente √©tude, on sait que les d√©penses militaires ont une variance de \\(100\\) milliards carr√©s et sont ind√©pendantes. Vous souhaitez calculez un intervalle de confiance pour la moyenne de la population des d√©penses militaires √† un niveau de confiance de \\(95\\%\\). Quel est le quantile que vous devez utiliser ?




```{r}
opts <- c(
  "\\(1.64\\)",
   answer = "\\(1.96\\)",
 "\\(1.28\\)",
  "\\(1.04\\)"
)

```

```{r, results='asis'}
cat(longmcq2(opts))
```



<button class="custom-button hint" onclick="toggleAlert(event, 'Puisque la variance de la population est connue et que les donn√©es sont ind√©pendantes, nous utilisons le quantile de la distribution standard normale.', 'hint')"> ‚ùì Indice </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div> <div style="margin-top: 4px;"></div>

<button class="custom-button explanation" onclick="toggleAlert(event, 'Le quantile de la loi normale standard correspondant √† un niveau de confiance est donn√© par \\(z_{1-\\frac{\\alpha}{2}} = z_{0.975} \\approx 1.959964 \\approx 1.96\\).', 'explanation')"> üí° Explication </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div>


## Question 3

Calculez un intervalle de confiance pour la moyenne de la population des d√©penses militaires √† un niveau de confiance de \\(95\\%\\) et en consid√©rant la variance des d√©penses militaires donn√©e dans la question \\(2\\).


```{r}
opts <- c(
  "\\([55.64634, 62.49652]\\)",
  "\\([56.82210, 61.32076]\\)",
  answer = "\\([53.83311, 64.30975]\\)",
  "\\([57.89653, 60.24633]\\)"
)

```

```{r, results='asis'}
cat(longmcq2(opts))
```


<button class="custom-button hint" onclick="toggleAlert(event, 'Utilisez la formule de l\'intervalle de confiance : \\(\\bar{X} \\pm z_{1-\\frac{\\alpha}{2}} \\cdot \\frac{\\sigma}{\\sqrt{n}}\\), o√π \\(\\bar{X}\\) est la moyenne de l\'√©chantillon, \\(z_{1-\\frac{\\alpha}{2}}\\) est le quantile de la distribution normale standard, \\(\\sigma\\) est l\'√©cart-type de la population, et \\(n\\) est la taille de l\'√©chantillon.', 'hint')"> ‚ùì Indice </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div> <div style="margin-top: 4px;"></div>

<button class="custom-button explanation" onclick="toggleAlert(event, 'L\'intervalle de confiance est calcul√© comme suit : \\(\\bar{X} = 59.07143, z = 1.96, \\sigma = 10\\), et \\(n = 14\\). Donc, l\'intervalle de confiance est \\(59.07143 \\pm 1.96 \\cdot \\frac{10}{\\sqrt{14}} = 59.07143 \\pm 5.238224\\), ce qui donne \\([53.83311,  64.30975]\\).', 'explanation')"> üí° Explication </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div>

## Question 4

Suposons maitenant que nous ne connaissions pas l'√©cart-type des d√©penses militaires par pays (pour la population), et que nous souhaitions construire un intervalle de confiance √† un niveau de confiance de \\(95\\%\\) en utilisant l'√©cart-type calcul√© sur l'√©chantillon. Suposez que les donn√©es sont normalement distribu√©es. Quel est le quantile que vous devez utiliser ?



```{r}
opts <- c(
  "\\(1.64\\)",
 "\\(1.76\\)",
  "\\(2.14\\)",
    answer = "\\(2.16\\)"
)

```

```{r, results='asis'}
cat(longmcq2(opts))
```



<button class="custom-button hint" onclick="toggleAlert(event, 'Puisque la variance de la population est inconnue et que l\'√©chantillon est petit, vous devez utiliser le quantile de la distribution t de Student avec \\(n-1\\) degr√©s de libert√©.', 'hint')"> ‚ùì Indice </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div> <div style="margin-top: 4px;"></div>



<button class="custom-button explanation" onclick="toggleAlert(event, 'Le quantile de la distribution t de Student pour un intervalle de confiance √† \\(95\\%\\) avec \\(13\\) degr√©s de libert√© (puisque \\(n = 14\\)) est approximativement \\(2.16\\).', 'explanation')"> üí° Explication </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div>

## Question 5

Calculez l'intervalle de confiance √† un niveau de confiance de \\(95\\%\\) pour la moyenne de la population des d√©penses militaires par pays en utilisant l'√©cart-type calcul√© sur l'√©chantillon \\(s\\) et en supposant que les donn√©es sont normalement distribu√©e et ind√©pendantes. 


```{r}
opts <- c(
    answer = "\\([53.34011, 64.80275]\\)",
  "\\([54.33841, 63.80445]\\)",
  "\\([ 55.46295, 62.67991]\\)",
  "\\([53.83321, 64.30965]\\)"
)

```



```{r, results='asis'}
cat(longmcq2(opts))
```


<button class="custom-button hint" onclick="toggleAlert(event, 'Utilisez la formule de l\'intervalle de confiance : \\(\\bar{X} \\pm t_{1-\\frac{\\alpha}{2}} \\cdot \\frac{s}{\\sqrt{n}}\\), o√π \\(\\bar{X}\\) est la moyenne de l\'√©chantillon, \\(t_{1-\\frac{\\alpha}{2}}\\) est le quantile de la distribution de Student, \\(s\\) est l\'√©cart-type de l\'√©chantillon, et \\(n\\) est la taille de l\'√©chantillon.', 'hint')"> ‚ùì Indice </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div> <div style="margin-top: 4px;"></div>

<button class="custom-button explanation" onclick="toggleAlert(event, 'L\'intervalle de confiance est calcul√© comme suit : \\(\\bar{X} = 59.07143, t_{1-\\frac{\\alpha}{2}} = 2.16, s = 9.926377\\), et \\(n = 14\\). Donc, l\'intervalle de confiance est \\(59.07143 \\pm 2.16 \\cdot \\frac{9.926377}{\\sqrt{14}} = 59.07143 \\pm 5.73132\\), ce qui donne \\([ 53.34011, 64.80275]\\).', 'explanation')"> üí° Explication </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div>

## Question 6
Quelle est l\'interpr√©tation correcte de cet intervalle de confiance dans ce contexte ?

```{r}
opts <- c(
          "La moyenne de la population se trouve dans cet intervalle avec une probabilit√© de \\(95\\%\\).",
          "\\(95 \\%\\) des donn√©es de l'√©chantillon se trouvent dans cet intervalle.",
          answer = "Si l\'on construit plusieurs intervalles de confiance de la m√™me mani√®re, alors environ \\(95\\%\\) des intervalles de confiance contiendront la moyenne de la population.",
          "L'intervalle contient \\(95\\%\\) de la population",
          "Il y a \\(95\\%\\) de chance que la moyenne de la population soit dans l'intervalle calcul√© sur cet √©chantillon."
)

```



```{r, results='asis'}
cat(longmcq2(opts))
```


<button class="custom-button hint" onclick="toggleAlert(event, 'Un param√®tre est ou n\'est pas inclus dans un intervalle de confiance.', 'hint')"> ‚ùì Indice </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div> <div style="margin-top: 4px;"></div>

<button class="custom-button explanation" onclick="toggleAlert(event, 'L\'id√©e est que si l\'on r√©p√®te l\'√©chantillonnage (et donc le calcul de l\'intervalle de confiance) un grand nombre de fois, environ \\(95 \\%\\) de ces intervalles contiendront la moyenne de la population, d\'o√π la troisi√®me proposition. L‚Äôincertitude porte sur la m√©thode et non sur le param√®tre (la moyenne de la population), qui est fixe, donc la premi√®re propostion est fausse. Une subtilit√© est que dans ce contexte, l\'intervalle de confiance est observ√© et donc fix√©, plus rien n\'est al√©atoire, donc la derni√®re propostion est fausse.', 'explanation')"> üí° Explication </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div>


---



Dans une usine de production de cosm√©tiques, une certaine cr√®me doit contenir en moyenne \\(50\\) mg d'un principe actif par dose. Pour v√©rifier si le processus de production respecte cette norme, un √©chantillon de \\(20\\) doses a √©t√© pr√©lev√©, et la quantit√© de principe actif dans chaque dose a √©t√© mesur√©e. La moyenne de principe actif contenu dans les \\(20\\) √©chantillons est de \\(50.3\\).

On sait √©galement que la variance de la population est \\(\\sigma^2 = 4\\) et que la quantit√© de principe actif par dose est distribut√©e normalement.


## Question 7
Vous souhaitez effectuer un test d'hypoth√®se pour d√©terminer si l'esp√©rance du principe actif par dose est significativement diff√©rente de \\(50\\) mg. D√©terminez l'hypoth√®se nulle et l'hypoth√®se alternative du test que vous vous souhaitez effectuer.

```{r}
opts <- c(
  "\\(H_0: \\mu = 50, H_{\\alpha}: \\mu > 50\\)",
    answer =   "\\(H_0: \\mu = 50, H_{\\alpha}: \\mu \\neq 50\\)",
   "\\(H_0: \\mu \\neq 50 , H_{\\alpha}: \\mu = 50\\)",
 "\\(H_0: \\mu > 50, H_{\\alpha}: \\mu = 50 \\)",
  "\\(H_0: \\mu = 50, H_{\\alpha}: \\mu < 50\\)"

)

```



```{r, results='asis'}
cat(longmcq2(opts))
```


<button class="custom-button hint" onclick="toggleAlert(event, 'L\'hypoth√®se nulle (\\(H_0\\)) suppose que l\'esp√©rance du principe actif par dose est de \\(50\\) mg. L\'hypoth√®se alternative (\\(H_{\\alpha}\\)) sugg√®re que l\'esp√©rance du principe actif par dose est diff√©rente de \\(50\\) mg.', 'hint')"> ‚ùì Indice </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div> <div style="margin-top: 4px;"></div>

<button class="custom-button explanation" onclick="toggleAlert(event, 'Les hypoth√®ses sont formul√©es comme suit : \\(H_0: \\mu = 50, H_{\\alpha}: \\mu \\neq 50\\)', 'explanation')"> üí° Explication </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div>


## Question  8

Calculez la statistique de test associ√©.

```{r}
opts <- c(
  answer = "\\(z_{obs} = 0.67\\)",
  "\\(z_{obs} = 1.34\\)",
  "\\(z_{obs} = 2.12\\)",
  "\\(z_{obs} = 1.50\\)",
  "\\(z_{obs} = 3\\)"
)

```





```{r, results='asis'}
cat(longmcq2(opts))
```


<button class="custom-button hint" onclick="toggleAlert(event, 'Utiliser la formule \\(z_{obs} = \\frac{\\bar{X} - \\mu_0}{\\sigma / \\sqrt{n}}\\)', 'hint')"> ‚ùì Indice </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div><div style="margin-top: 4px;"></div>


<button class="custom-button explanation" onclick="toggleAlert(event, 'On a \\(z_{obs} = \\frac{50.3 - 50}{2 / \\sqrt{20}} = \\frac{0.3}{0.447} \\approx 0.67\\). La statistique de test est donc \\(z_{obs} = 0.67\\).', 'explanation')"> üí° Explication </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div>



## Question 9

Calculez la p-valeur associ√©e √† ce test.

```{r}
opts <- c(

  "\\(0.045\\)",
  "\\(0.125\\)",
  "\\(0.455\\)",
    answer = "\\(0.502\\)",
  "\\(0.752\\)"
)

```





```{r, results='asis'}
cat(longmcq2(opts))
```


<button class="custom-button hint" onclick="toggleAlert(event, 'Calculez la p-valeur d‚Äôun test bilat√©ral pour \\(z_{obs} = 0.67\\).', 'hint')"> ‚ùì Indice </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div><div style="margin-top: 4px;"></div>

<button class="custom-button explanation" onclick="toggleAlert(event, 'Pour un test bilat√©ral, la p-valeur est \\(2 \\cdot P(Z > |0.67|) = 2 \\cdot (1 - 0.7486) = 0.5028\\).', 'explanation')"> üí° Explication </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div>



## Question 10

Peut-on rejeter l‚Äôhypoth√®se nulle au niveau de signification de \\(5\\%\\), en se basant sur la statistique de test calcul√©e pr√©c√©dement ?

```{r}
opts <- c(
  "Oui, car la p-valeur est sup√©rieure √† \\(0.05\\)",
  answer = "Non, car la p-valeur est sup√©rieure √† \\(0.05\\)",
  "Oui, car la p-valeur est inf√©rieure √† \\(0.05\\)",
  "Non, car la p-valeur est inf√©rieure √† \\(0.05\\)",
  "Impossible de conclure sans conna√Ætre la moyenne"
)

```



```{r, results='asis'}
cat(longmcq2(opts))
```

<button class="custom-button hint" onclick="toggleAlert(event, 'Calculez la p-valeur d‚Äôun test bilat√©ral pour \\(z_{obs} = 0.67\\) et comparer la p-valeur au niveau de signification \\(\\alpha\\).', 'hint')"> ‚ùì Indice </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div><div style="margin-top: 4px;"></div>

<button class="custom-button explanation" onclick="toggleAlert(event, 'Pour un test bilat√©ral, la p-valeur est \\(2 \\cdot P(Z > |0.67|) = 2 \\cdot (1 - 0.7486) = 0.5028\\). Comme \\(0.5028 > 0.05\\), on ne rejette pas \\(H_0\\) au niveau de signification de 5 %.', 'explanation')"> üí° Explication </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div>


## Question 11
On souhaite estimer une moyenne avec une marge d‚Äôerreur de \\(0.5\\), un niveau de confiance de \\(95 \\%\\), et un √©cart-type \\(\\sigma\\) de \\(2\\). Quelle taille minimale d‚Äô√©chantillon faut-il ? 

```{r}
opts <- c("\\(8\\)", "\\(16\\)", "\\(31\\)", answer="\\(62\\)", "\\(246\\)")

```



```{r, results='asis'}
cat(longmcq2(opts))
```


<button class="custom-button hint" onclick="toggleAlert(event, 'Utiliser la formule pour la taille d\'√©chantillon \\(n\\) donn√©e dans les slides et le bon quantile.', 'hint')"> ‚ùì Indice </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div> <div style="margin-top: 4px;"></div>

<button class="custom-button explanation" onclick="toggleAlert(event, 'La formule a utilis√© est \\(n=(z_{1-\\alpha/2}\\sigma/E)^2\\) avec \\(z_{1-\\alpha/2}=z_{0.975}\\approx 1.96\\), \\(E=0.5\\) et \\(\\sigma=2\\). On obtient \\(n=(1.96\\cdot2\\cdot2)^2\\approx 61.47\\Rightarrow62.\\)', 'explanation')"> üí° Explication </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div>

## Question 12
Un test-t unilat√©ral √† droite est men√© sur un √©chantillon de \\(15\\) observations, avec une statistique de test \\(t_{\\text{obs}}=2.5\\). Le niveau de signification est \\(\\alpha=0.05\\). Faut-il rejeter l\'hypoth√®se nulle ?

```{r}
opts <- c("Non, car \\(2.5<t_{0.95,14}\\).", 
          answer = "Oui, car \\(2.5>t_{0.95,14}\\).", 
          "Non, car \\(2.5<t_{0.05,14}\\).", 
          "Oui, car \\(2.5>z_{0.95}\\).", 
          "Impossible de conclure sans conna√Ætre la moyenne.")

```



```{r, results='asis'}
cat(longmcq2(opts))
```


<button class="custom-button hint" onclick="toggleAlert(event, 'Calculez la bonne valeur critique.', 'hint')"> ‚ùì Indice </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div> <div style="margin-top: 4px;"></div>

<button class="custom-button explanation" onclick="toggleAlert(event, 'On rejette \\(H_0\\) si \\(t_{\\text{obs}}>t_{1-\\alpha,\\text{df}}\\). Ici \\(\\alpha=0.05\\), \\(\\text{df}=n-1=14\\) et \\(t_{1-\\alpha, \\text{df}}=1.7613\\) selon la table dans les slides. Donc on rejette \\(H_0\\) car \\(2.5>1.7613\\).', 'explanation')"> üí° Explication </button><div class="alert alert-info" style="display: none;"> <strong class="alertType"></strong>: <span class="alertMessage"></span> </div>


